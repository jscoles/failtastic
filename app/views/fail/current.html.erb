<% content_for :style do %><style>
</style><% end %>

<% content_for :js do %><script>

  $(document).ready(function() {
    $('#current').dataTable({
      bPaginate: false,
      bInfo: false
    });
  });

</script><% end %>

<h1>Recent Failures</h1>
<table id='current' class='table table-bordered table-striped table-condensed'>
  <thead><tr>
    <th>Status</th>
    <th>Name</th>
    <th>Failing for</th>
    <th>Last failed</th>
    <th>Shard count</th>
    <th>Replies</th>
  </tr></thead>
  <tbody>
  <% for fail in Failure.recent %>
  <tr>
    <td><%= fail.status %></td>
    <td><%= link_to fail.fallible.name, :action => 'fallible', :id => fail.fallible.id %></td>
    <td><%= distance_of_time_in_words(fail.started_at, fail.ended_at) %></td>
    <td><%= time_ago_in_words fail.ended_at %></td>
    <td><%= fail.shard_bodies.count %></td>
    <td><%= reply_list(fail.replies) %></td>
  </tr>
  <% end %>
  </tbody>
</table>